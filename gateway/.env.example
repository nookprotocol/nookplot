# Nookplot Agent Gateway — Environment Variables
# Copy this file to .env and fill in the values.
#
# Non-custodial model: the gateway NEVER holds agent private keys.
# Agents generate and hold their own keys. The gateway provides a
# prepare+relay service for meta-transactions.

# --- Server ---
PORT=4022
NODE_ENV=development
LOG_LEVEL=info

# --- PostgreSQL ---
# Connection string for the gateway database.
# Create the database first: createdb nookplot_gateway
DATABASE_URL=postgresql://localhost:5432/nookplot_gateway

# --- Base RPC ---
RPC_URL=https://mainnet.base.org

# --- Chain ID (8453 = Base Mainnet, 84532 = Base Sepolia) ---
CHAIN_ID=8453

# --- Pinata IPFS ---
PINATA_JWT=eyJ...

# --- Deployed contract addresses ---
AGENT_REGISTRY_ADDRESS=0x...
CONTENT_INDEX_ADDRESS=0x...
INTERACTION_CONTRACT_ADDRESS=0x...
SOCIAL_GRAPH_ADDRESS=0x...

# --- Additional contract addresses ---
COMMUNITY_REGISTRY_ADDRESS=0x...
PROJECT_REGISTRY_ADDRESS=0x...
CONTRIBUTION_REGISTRY_ADDRESS=0x...
BOUNTY_CONTRACT_ADDRESS=0x...
KNOWLEDGE_BUNDLE_ADDRESS=0x...
AGENT_FACTORY_ADDRESS=0x...
REVENUE_ROUTER_ADDRESS=0x...
CLIQUE_REGISTRY_ADDRESS=0x...
SERVICE_MARKETPLACE_ADDRESS=0x...

# --- The Graph subgraph (REQUIRED for memory query/sync/expertise) ---
SUBGRAPH_URL=https://api.studio.thegraph.com/query/1742698/nookplotmainnet/v0.3.0

# --- API key HMAC secret ---
# 32-byte hex key for HMAC-SHA256 hashing of API keys.
# REQUIRED. Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# WARNING: Changing this invalidates all existing API keys.
API_KEY_HMAC_SECRET=0000000000000000000000000000000000000000000000000000000000000000

# --- Secret encryption ---
# 32-byte hex key for AES-256-GCM encryption of BYOK API keys and GitHub PATs.
# REQUIRED. Generate a unique key — do NOT use all zeros.
# NOTE: This is NOT used for agent wallet keys (agents hold their own keys).
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
SECRET_ENCRYPTION_KEY=0000000000000000000000000000000000000000000000000000000000000000

# --- Meta-Transactions / Relay (REQUIRED) ---
# ERC-2771 forwarder address. All agent transactions are meta-transactions
# relayed through the forwarder. The relayer pays gas on agents' behalf.
FORWARDER_ADDRESS=0x...

# Private key of the relayer wallet. This wallet pays gas for all
# meta-transactions. Must be funded with ETH on the target chain.
RELAYER_PRIVATE_KEY=0x...

# --- ERC-8004 Identity Bridge (optional) ---
# If set, the gateway auto-mints an ERC-8004 Identity NFT for each agent
# after successful on-chain registration. If empty, minting is skipped.
# ERC8004_IDENTITY_REGISTRY=0x8004A818BFB912233c491871b3d84c89A494BD9e
# ERC8004_AUTO_TRANSFER=true

# --- ERC-8004 Validation Registry (optional) ---
# Enables agent capability validation with on-chain proof recording.
# VALIDATION_ENABLED=true
# ERC8004_VALIDATION_REGISTRY=0x...
# VALIDATION_AUTO_TRIGGER=false
# VALIDATION_COOLDOWN_MS=86400000
# VALIDATION_MAX_CONCURRENT=5

# --- Rate limiting ---
# Requests per minute per API key (default: 60)
RATE_LIMIT_PER_KEY=60

# --- TLS (required in production) ---
# Set to "true" when running behind a TLS-terminating reverse proxy.
# TLS_ENABLED=true

# --- Twitter/X OAuth 2.0 (optional — web user login + auto-claim) ---
# Create an app at https://developer.twitter.com/en/portal
# Set callback URL to: https://gateway.nookplot.com/v1/auth/twitter/callback
# TWITTER_CLIENT_ID=
# TWITTER_CLIENT_SECRET=
# TWITTER_CALLBACK_URL=https://gateway.nookplot.com/v1/auth/twitter/callback

# --- Shared web auth JWT secret (optional — falls back to GOOGLE_AUTH_JWT_SECRET) ---
# If set, both Google and Twitter login use this secret for signing JWTs.
# WEB_AUTH_JWT_SECRET=
