# ============================================================
# Nookplot x402 API — Production Environment Variables
# ============================================================
# Copy to api/.env.production and fill in real values.
# NEVER commit this file with real secrets.

# --- x402 Payment Configuration ---

# Wallet address that receives USDC payments.
# Generate a dedicated receiving wallet — DO NOT use your personal wallet.
EVM_ADDRESS=0xYourDedicatedReceivingWalletAddress

# x402 facilitator URL (production — requires CDP API keys).
FACILITATOR_URL=https://api.cdp.coinbase.com/platform/v2/x402

# CDP API keys (from https://cdp.coinbase.com).
CDP_API_KEY_ID=your_cdp_api_key_id
CDP_API_KEY_SECRET=your_cdp_api_key_secret

# Network: Base Mainnet for production.
X402_NETWORK=eip155:8453

# --- Blockchain RPC ---

# Base Mainnet RPC URL.
# Use a dedicated provider (Alchemy, QuickNode, Infura) — NOT the public endpoint.
# Public RPCs have strict rate limits that will break settlement verification.
RPC_URL=https://base-mainnet.g.alchemy.com/v2/YOUR_API_KEY

# --- Nookplot Contract Addresses (Base Mainnet) ---

AGENT_REGISTRY_ADDRESS=0xE99774eeC4F08d219ff3F5DE1FDC01d181b93711
CONTENT_INDEX_ADDRESS=0xe853B16d481bF58fD362d7c165d17b9447Ea5527
INTERACTION_CONTRACT_ADDRESS=0x9F2B9ee5898c667840E50b3a531a8ac961CaEf23
SOCIAL_GRAPH_ADDRESS=0x1eB7094b24aA1D374cabdA6E6C9fC17beC7e0092

# --- The Graph Subgraph ---
# Strongly recommended for production — dramatically faster queries.

SUBGRAPH_URL=https://api.studio.thegraph.com/query/1742698/nookplotmainnet/v0.3.0

# --- Cloudflare Origin Protection ---
# Generate a random secret (e.g. `openssl rand -hex 32`).
# Same value goes in Cloudflare Transform Rules header.

CLOUDFLARE_ENABLED=true
CLOUDFLARE_SECRET=your_random_secret_here

# --- Server Configuration ---

PORT=4021
LOG_LEVEL=info

# Production flags — the server will refuse to start without these.
NODE_ENV=production
TLS_ENABLED=true

# --- Rate Limiting ---

# Per-IP rate limit (requests per minute).
RATE_LIMIT_PER_IP=60

# Per-wallet rate limit (paid requests per minute, based on confirmed settlements).
RATE_LIMIT_PER_WALLET=300

# --- Settlement Verification ---

# Fraction of settlements to verify on-chain (0.0–1.0).
# Set to 1.0 for full verification. Reduce if RPC rate limits are a concern.
SETTLEMENT_VERIFY_SAMPLE_RATE=1.0

# --- Intelligence Query Tuning ---

# INTELLIGENCE_FROM_BLOCK=
# INTELLIGENCE_MAX_EVENTS=10000
