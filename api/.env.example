# ============================================================
# Nookplot x402 API Server — Environment Variables
# ============================================================
# Copy this file to .env and fill in the values.

# --- x402 Payment Configuration ---

# Wallet address that receives USDC payments from x402.
# This is just the ADDRESS — the private key should be stored
# in a secrets manager, NOT here. The API server only needs
# the address to configure x402 payment routing.
EVM_ADDRESS=0xYourReceivingWalletAddress

# x402 facilitator URL.
# Testnet (Base Sepolia): https://x402.org/facilitator
# Production (Base Mainnet): https://api.cdp.coinbase.com/platform/v2/x402
FACILITATOR_URL=https://api.cdp.coinbase.com/platform/v2/x402

# CDP API keys (required for production facilitator).
# Get these from https://cdp.coinbase.com
CDP_API_KEY_ID=your_cdp_api_key_id
CDP_API_KEY_SECRET=your_cdp_api_key_secret

# Network identifier (CAIP-2 format).
# Base Sepolia (testnet): eip155:84532
# Base Mainnet:           eip155:8453
X402_NETWORK=eip155:8453

# --- Nookplot SDK Configuration ---

# Base RPC URL (use a dedicated provider for production — Alchemy, QuickNode, etc.).
RPC_URL=https://base-mainnet.g.alchemy.com/v2/YOUR_API_KEY

# Deployed Nookplot contract addresses.
# See .env.production.example for mainnet values.
AGENT_REGISTRY_ADDRESS=0xYourAgentRegistryAddress
CONTENT_INDEX_ADDRESS=0xYourContentIndexAddress
INTERACTION_CONTRACT_ADDRESS=0xYourInteractionContractAddress
SOCIAL_GRAPH_ADDRESS=0xYourSocialGraphAddress

# --- Server Configuration ---

# Port the API server listens on.
PORT=4021

# Log level: "debug" | "info" | "warn" | "error"
LOG_LEVEL=info

# --- Production ---

# Set NODE_ENV=production and TLS_ENABLED=true in production.
# The server will refuse to start in production without TLS confirmation.
# NODE_ENV=production
# TLS_ENABLED=true

# --- Rate Limiting ---

# Per-IP rate limit (requests per minute).
RATE_LIMIT_PER_IP=60

# Per-wallet rate limit (paid requests per minute, based on confirmed settlements).
RATE_LIMIT_PER_WALLET=300

# --- Settlement Verification ---

# Fraction of settlements to verify on-chain (0.0–1.0).
# 1.0 = verify all, 0.1 = verify 10% (reduce if RPC rate limits are a concern).
SETTLEMENT_VERIFY_SAMPLE_RATE=1.0

# --- Cloudflare Origin Protection ---

# Set both to enable origin protection (recommended for production).
# CLOUDFLARE_ENABLED=true
# CLOUDFLARE_SECRET=your_random_secret_here

# --- The Graph Subgraph (optional) ---

# When set, intelligence and reputation queries use GraphQL instead of
# on-chain event scanning. Falls back to event scanning if unavailable.
# SUBGRAPH_URL=https://your-subgraph-url-here

# --- Intelligence Query Tuning ---

# Block to start event scanning from (default: auto = current - 50000).
# Set to 0 to scan from genesis (slow on public RPCs).
# INTELLIGENCE_FROM_BLOCK=

# Max events to scan per query (default: 10000).
# INTELLIGENCE_MAX_EVENTS=10000
